
from Bio.Align import substitution_matrices

from .utils import reduce_alphabet


ALPHABET = "ACDEFGHIKLMNPQRSTVWY"

BLOSUM62 = reduce_alphabet(substitution_matrices.load("BLOSUM62"), ALPHABET)


ATCHLEY_FACTORS = {
    "A": [-0.591, -1.302, -0.733, 1.570, -0.146],
    "C": [-1.343, 0.465, -0.862, -1.020, -0.255],
    "D": [1.050, 0.302, -3.656, -0.259, -3.242],
    "E": [1.357, -1.453, 1.477, 0.113, -0.837],
    "F": [-1.006, -0.590, 1.891, -0.397, 0.412],
    "G": [-0.384, 1.652, 1.330, 1.045, 2.064],
    "H": [0.336, -0.417, -1.673, -1.474, -0.078],
    "I": [-1.239, -0.547, 2.131, 0.393, 0.816],
    "K": [1.831, -0.561, 0.533, -0.277, 1.648],
    "L": [-1.019, -0.987, -1.505, 1.266, -0.912],
    "M": [-0.663, -1.524, 2.219, -1.005, 1.212],
    "N": [0.945, 0.828, 1.299, -0.169, 0.933],
    "P": [0.189, 2.081, -1.628, 0.421, -1.392],
    "Q": [0.931, -0.179, -3.005, -0.503, -1.853],
    "R": [1.538, -0.055, 1.502, 0.440, 2.897],
    "S": [-0.228, 1.399, -4.760, 0.670, -2.647],
    "T": [-0.032, 0.326, 2.213, 0.908, 1.313],
    "V": [-1.337, -0.279, -0.544, 1.242, -1.262],
    "W": [-0.595, 0.009, 0.672, -2.128, -0.184],
    "Y": [0.260, 0.830, 3.097, -0.838, 1.51]
}


KIDERA_FACTORS = {
    "A": [-1.56, -1.67, -0.97, -0.27, -0.93, -0.78, -0.2, -0.08, 0.21, -0.48],
    "C": [0.12, -0.89, 0.45, -1.05, -0.71, 2.41, 1.52, -0.69, 1.13, 1.1],
    "D": [0.58, -0.22, -1.58, 0.81, -0.92, 0.15, -1.52, 0.47, 0.76, 0.7],
    "E": [-1.45, 0.19, -1.61, 1.17, -1.31, 0.4, 0.04, 0.38, -0.35, -0.12],
    "F": [-0.21, 0.98, -0.36, -1.43, 0.22, -0.81, 0.67, 1.1, 1.71, -0.44],
    "G": [1.46, -1.96, -0.23, -0.16, 0.1, -0.11, 1.32, 2.36, -1.66, 0.46],
    "H": [-0.41, 0.52, -0.28, 0.28, 1.61, 1.01, -1.85, 0.47, 1.13, 1.63],
    "I": [-0.73, -0.16, 1.79, -0.77, -0.54, 0.03, -0.83, 0.51, 0.66, -1.78],
    "K": [-0.34, 0.82, -0.23, 1.7, 1.54, -1.62, 1.15, -0.08, -0.48, 0.6],
    "L": [-1.04, 0.0, -0.24, -1.1, -0.55, -2.05, 0.96, -0.76, 0.45, 0.93],
    "M": [-1.4, 0.18, -0.42, -0.73, 2.0, 1.52, 0.26, 0.11, -1.27, 0.27],
    "N": [1.14, -0.07, -0.12, 0.81, 0.18, 0.37, -0.09, 1.23, 1.1, -1.73],
    "P": [2.06, -0.33, -1.15, -0.75, 0.88, -0.45, 0.3, -2.3, 0.74, -0.28],
    "Q": [-0.47, 0.24, 0.07, 1.1, 1.1, 0.59, 0.84, -0.71, -0.03, -2.33],
    "R": [0.22, 1.27, 1.37, 1.87, -1.7, 0.46, 0.92, -0.39, 0.23, 0.93],
    "S": [0.81, -1.08, 0.16, 0.42, -0.21, -0.43, -1.89, -1.15, -0.97, -0.23],
    "T": [0.26, -0.7, 1.21, 0.63, -0.1, 0.21, 0.24, -1.15, -0.56, 0.19],
    "V": [-0.74, -0.71, 2.04, -0.4, 0.5, -0.81, -1.07, 0.06, -0.46, 0.65],
    "W": [0.3, 2.1, -0.72, -1.57, -1.16, 0.57, -0.48, -0.4, -2.3, -0.6],
    "Y": [1.38, 1.48, 0.8, -0.56, 0.0, -0.68, -0.31, 1.03, -0.05, 0.53]
}


BLOSUM_INDICES = {
    "A": [0.08, -0.92, 0.53, 0.0, 0.24, 0.19, 0.66, -0.05, 1.36, 0.33],
    "C": [-1.08, -1.11, 1.56, 0.81, 1.83, -1.05, -0.74, 0.38, -0.12, -0.1],
    "D": [1.55, 0.01, 0.32, 0.49, -0.99, 0.01, -1.62, 0.53, -0.15, -0.28],
    "E": [1.48, 0.23, -0.67, -0.36, -0.28, -0.08, -1.01, 0.36, 0.77, 0.3],
    "F": [-1.62, 1.01, -0.31, 0.62, -0.55, 0.29, -0.02, 0.1, 0.43, -1.29],
    "G": [0.85, 0.17, 1.73, 0.09, -0.55, 1.19, 1.21, 0.87, 0.01, 0.24],
    "H": [0.72, 1.55, -0.8, 1.55, 0.35, -0.79, 0.66, -0.08, -0.19, 0.99],
    "I": [-1.46, -1.13, -0.76, 0.38, -0.6, 0.28, -0.13, 0.2, -0.22, 0.21],
    "K": [1.14, -0.04, -0.8, -0.85, 0.82, 0.1, 0.21, 0.13, 0.18, -0.85],
    "L": [-1.41, -0.86, -0.88, -0.17, 0.03, 0.34, 0.11, 0.15, -0.44, -0.02],
    "M": [-0.96, -0.59, -0.97, -0.53, 0.24, 0.37, 0.06, 0.21, -0.56, 0.36],
    "N": [1.51, 0.22, -0.05, 1.01, 0.12, 0.83, -0.03, -0.57, -1.2, -0.14],
    "P": [0.88, -0.68, 0.38, -0.87, -1.24, -2.02, 0.85, -0.35, -0.42, -0.3],
    "Q": [1.09, 0.3, -0.87, -0.72, 0.5, -0.08, -0.44, 0.2, 0.38, 0.67],
    "R": [1.01, 0.19, -0.86, -0.61, 1.28, 0.2, 0.66, 0.18, -0.22, -0.52],
    "S": [0.84, -0.45, 0.42, 0.32, 0.2, 0.54, 0.01, -0.8, 0.62, -0.13],
    "T": [0.19, -0.73, 0.18, -0.01, 0.02, 0.38, -0.3, -1.96, 0.15, 0.06],
    "V": [-1.13, -1.23, -0.63, 0.06, -0.6, 0.16, 0.01, 0.02, 0.25, 0.61],
    "W": [-1.58, 2.28, 1.17, -1.61, 0.12, 0.24, -0.54, -0.4, -0.35, 0.5],
    "Y": [-1.14, 1.74, -0.58, 0.75, -0.12, -0.48, 0.24, -0.25, 0.71, -0.25]
}
